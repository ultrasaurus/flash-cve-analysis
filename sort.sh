#!/bin/bash
# sort vulnerabilities into categories

rm -rf tmp.csv
cp flash.csv tmp.csv

cat terms.txt | while read line
do
  #grep -i "${line}" flash.csv | wc -l 
  count=($(  grep -i "${line}" tmp.csv | wc -l ))
  echo -e "$count\t$line"
  filename=${line//[\. ]/-}.txt
  grep -i -G "${line}" tmp.csv > out/$filename
  grep -v -i -G "${line}" tmp.csv > out.csv
  rm tmp.csv; cp out.csv tmp.csv
done

cat tmp.csv | wc -l